// Import the PWA service worker generated by next-pwa
if (typeof self !== 'undefined') {
    importScripts('/worker-pwa.js');
}

// Check if Firebase is available
if (typeof firebase !== 'undefined' && typeof firebase.messaging !== 'undefined') {
    // Initialize Firebase
    const firebaseConfig = {
        apiKey: "AIzaSyDizs1-cOZnBX5ilBXazQIuFJD_sUnkDCQ",
        authDomain: "studio-1326322560-ad791.firebaseapp.com",
        projectId: "studio-1326322560-ad791",
        storageBucket: "studio-1326322560-ad791.appspot.com",
        messagingSenderId: "417616889091",
        appId: "1:417616889091:web:f2c93816e5eaec7ff4d536"
    };

    firebase.initializeApp(firebaseConfig);

    const messaging = firebase.messaging();

    messaging.onBackgroundMessage((payload) => {
        console.log('[firebase-messaging-sw.js] Received background message ', payload);
        const notificationTitle = payload.notification.title;
        const notificationOptions = {
            body: payload.notification.body,
            icon: payload.notification.icon,
        };

        if (self.registration) {
             self.registration.showNotification(notificationTitle, notificationOptions);
        }
    });
} else {
    console.error("Firebase or Firebase Messaging is not available in the service worker.");
}
